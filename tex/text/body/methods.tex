\section{Methods} \label{sec:methods}

After opening with a brief primer on hereditary stratigraphy and an overview of application in proposed ``gene-'' and ``species-level'' instrumentation (Section \ref{sec:genome-instrumentation}), discussion turns to cover debuted inferential techniques and corresponding validation experiments.
Three inferential techniques are introduced:
\begin{enumerate}
\item genealogical inference (Section \ref{sec:genealogical-inference}),
\item effective population size inference (Section \ref{sec:population-size-inference}), and
\item positive selection inference (Section \ref{sec:selection-inference}).
\end{enumerate}

The first two rely on ``species-level'' annotation.
Section \ref{sec:one-max} introduces the simple ``one-max'' problem used for validation experiments of genealogical and population size inference.
The third, selection inference, applies ``gene-level'' instrumentation.
Section \ref{sec:software-data} closes with information on software and data associated with this work.

\input{text/body/methods/genome-instrumentation.tex}

\subsection{One-Max Task}
\label{sec:one-max}

We used the one-max task for experiments to evaluate population size inference and genealogical inference.
This tasks selects over fixed-length bit string individuals for the fraction of 1's set.
Each individual was represented as a binary string of length 100.
Fitness was evaluated as the sum of the bits in the binary string, preferring individuals with more 1s over individuals with fewer.
Population size was 200 individuals, initialized randomly with sites set to 1 with probability 0.5.
In treatments where population size decreased during an evolutionary run, excess individuals were eliminated randomly.
In treatments where population size increased during an evolutionary run,
new population slots were filled through selection over the existing population.

Selection was performed using the tournament selection method.
Default tournament size was 2.
Tournament sizes 1 and 8 were also set in certain treatments.
Tournaments were performed synchronously, with all parents selected before turnover of the entire population.
Evolutionary runs lasted 100 generations.
Two-point crossover (mating) and bit-flip mutation with per-bit probability 0.05 were applied to all organisms at all generations prior to selection.
Operator choice and parameter selections were based on one-max example code from the Distributed Evolutionary Algorithms in Python package \citep{fortin2012deap}.

\input{text/body/methods/genealogical-inference.tex}

\input{text/body/methods/population-size-inference.tex}

\input{text/body/methods/selection-inference.tex}

\subsection{Software \& Data}
\label{sec:software-data}

Software, data, analyses, and supplementary materials are hosted via the Open Science Framework at \url{https://osf.io/xj5pn/}.

Data structures and algorithms associated with hereditary stratigraphy methodology are published in the \texttt{hstrat} Python package on PyPi and at \url{github.com/mmore500/hstrat} \citep{moreno2022hstrat}.
Recombination features and corresponding C++ implementations are on the project's roadmap.

Experiments benefited greatly from open source scientific software \citep{cock2009biopython,fortin2012deap,sand2014tqdist}.
The Alife data standard facilitated tool interoperation \citep{lalejini2019data}.
