\subsection{Genealogical Inference}
\label{sec:genealogical-inference}

This section describes evolutionary scenarios used to test genealogical inference then explains conversion of recorded sexual pedigrees to phylogenetic trees (for reference in evaluating reconstruction quality).

\textbf{Validation Experiment.}
This experiment tested the quality of genealogical history recovered from species-level  annotation.
Trials covered three evolutionary scenarios.
The first, ``allopatry,'' induced full speciation through introduction of a total reproductive barrier among subpopulations.
The second, ``ring,'' induced partial phylogenetic structure through an island model with small amounts of migration.
Finally, a well-mixed control lacking meaningful phylogenetic structure was included.
Ten independent replicates were performed for each treatment.

Populations evolved on the simple one-max problem, described in Supplementary Section \ref{sec:one-max}.
At the 200th generation, species-level annotations were extracted from extant population members.
Phylogenetic reconstruction using agglomerative trie-based reconstruction techniques from \citep{moreno2023toward}.

To evaluate reconstruction quality, inferred phylogenies were compared to references distilled from the underlying pedigree record (described below).
Reconstruction error was quantified using quartet distance \citep{estabrook1985comparison,sand2014tqdist}.
Inferred phylogenies were also visualized to confirm recovery of major historical features.

\textit{Allopatry Treatment.}
This treatment simulates 100 generations of well-mixed sympatric evolution.
At generation 100, the population is divided into two 50-member subpopulations.
These subpopulations evolve independently for 50 generations.
Then, at generation 150, the first subpopulation is split again into five 10-member subpopulations.
All subpopulations then evolve independently for a further 50 generations.
Phylogenetic reconstruction from this treatment should recover a binary branching at generation 100 followed by a quintuple branching along one lineage at generation 150.

\textit{Ring Treatment.}
This treatment splits the population into ten distinct subpopulations (i.e., islands).
Islands connected in a ring topology.
One individual migrated between adjacent populations per generation.

\textit{Bag Treatment.}
This treatment applices a well-mixed population model.
As such, no meaningful phylogenetic structure exists to be detected.

\textbf{Phylogeny Extraction from Pedigree Records.}
In order to provide a baseline reference for evaluation of annotation-based phylogenetic reconstruction, phylogenetic trees (reflecting ``relatedness'') were extracted from full sexual pedigrees.

Such conversion has fundamental limitations: well-mixed populations of modest size lack structured differences in phylogenetic relatedness.
Although speciation and spatial structure introduce phylogenetic structure, this issue still arises among constituent well-mixed subpopulations.
No effort was made to condense such arbitrary branch structure, which could be achieved through clustering to a relatedness threshold.

Phylogenetic relationships were distilled from pedigree data through a two step process.
First, pairwise Most Recent Common Ancestor (MRCA) depths were collated from the pedigree.
Then, UPGMA reconstruction was applied, yielding an inferred tree \citep{sokal1958university}.
Finally, branch lengths were corrected to accurately position leaf nodes at their known generational depths.
